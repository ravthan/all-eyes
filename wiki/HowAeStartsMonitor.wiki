#summary How to start the 'ae' daemon
= PROCEDURE FOR AE-DAEMON TO START UP A  MONITOR=

'ae' daemon spawns, monitors and if necessary kills the monitors.  The monitors are configured at the compile time with the daemon.  Based on the configuration, daemon calls correspondig monitor fucntion after doing the following list of things:

    # 'fork' a new process
    # The ae-daemon creates a pair of SOCKET STREAM and re-directs the STDIN/STDOUT to the monitors
    # Clear out other monitor's details and closes the other monitor's socketpair's file descriptors.
    # Sets up the SIGCHLD signal to ignore.
    # Drops the privileges.  This step contains two parts: one is to change the root (/) to chroot-jail, and then do setuid to 'ae' user.
    # Marks the monitor has running and calls the monitor's C function.  Note that some monitors may exec a PERL/PYTHON/Java/RUBY (or any other language program) to implement a monitor.


The protocol between the ae-daemon and the monitor is defined in page http://code.google.com/p/all-eyes/wiki/AeMonitorProtocol?ts=1351811756&updated=AeMonitorProtocol

   # What the ae-daemon should check?
       * The ae-daemon should kill and restart the monitor process if it hasn't received the message within 30 seconds after the monitor is running.
       * The ae-daemon should kills and restart the monitor process if it received message does not confirm to the AeMonitorProtocl.
       * The ae-daemon kills and restarts the monitor, if the reestablished the SOCKET STREAM, communication is broken.