The protocol specification for ae daemon and monitors

=AE-DAEMON/MONITORS PROTOCOL SPECIFICATION=
Between the ae ademon and monitors, the protocol is request/response style and there are 2 class of messages:
   * Control Message
   * Event Message
  

==Control Message==
The control message is defined to be

   ===_*`[``:``<`Text-Header`>``:``]`*_===

Where the _*`[``:`*_ is the beginning marker and the _*`:``]`*_ is the ending marker.

The field _*`<`Text-Header`>`*_ is defined to be

   _*`<`version`>``:``<`name`>``:``<`msg-type`>`*_

Where the  _*:*_ is the sub-field delimiter. Each sub-field is defined in the tables below.

_*`<`version`>`*_ - Protocol version
|| *Value* || *Comment* ||
|| 10 || Valid version number ||

_*`<`name`>`*_ - Monitor name
|| *Value* || *Comment* ||
|| AE || For ae daemon ||
|| SM || For socket monitor ||
|| PM || For proc monitor ||
|| FL || For file monitor || 
|| FD || For file descriptor monitor || 
|| SF || For ae itself monitor ||

_*`<`msg-type`>`*_ - Message type
|| *Value* || *Comment* ||
|| 00 || The HELLO message ||
|| 11 || The ACK message ||
|| 22 || The event message ||
|| 99 || The initial channel establishment ||

==Event Message==
The event message is defined to be

   _*`[``:``<`Text-Header`>``:``<`event-id`>``:``<`status-op`>``:``<`action-list`>``:``<`text`>``:``]`*_

Where the _*`[``:`*_ is the beginning marker, the _*`:``]`*_ is the ending marker, and the _*`:`*_ is the field delimiter.

The field _*`<`Text-Header`>`*_ is defined under the control message header above. For the rest of fields, they are defined in the tables below.

_*`<`event-id`>`*_ - Event associated with the monitor sensors
|| *Value* || *Comment* ||
|| 0001 || The Black List port is up. Reported by socketmon. ||
|| 0002 || The required port is down. Reported by socketmon. ||
|| etc || Other event codes ... ||

_*`<`status-op`>`*_ - Status code or opcode of the monitor.
|| *Value* || *Comment* ||
|| 00 || GREEN ||
|| 01 || ORANGE ||
|| 11 || RED ||

_*`<`action-list`>`*_ - An array of possible action list for that event defined by _*`<`event-id`>`*_. 
|| *Value* || *Comment* ||
|| A0 || Ignore ||
|| A1 || Restart||
|| A2 || Kill ||
|| etc || More actions ... ||

_*`<`text`>`*_ - A text message to be transmitted. This field is limited to 80 characters maximum.

==Examples==

